<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
   	<meta http-equiv="X-UA-Compatible" content="IE=Edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="renderer" content="webkit">

    <title>联系我们信息</title>

    <link href="${resRoot}/css/bootstrap.min14ed.css" rel="stylesheet">
    <link href="${resRoot}/css/font-awesome.min93e3.css" rel="stylesheet">
    <link href="${resRoot}/css/plugins/iCheck/custom.css" rel="stylesheet">

    <link href="${resRoot}/css/animate.min.css" rel="stylesheet">
    <link href="${resRoot}/css/style.min862f.css" rel="stylesheet">
    
</head>

<body class="gray-bg">
    <div class="wrapper wrapper-content animated fadeInRight">

            <div class="row">
                <div class="col-sm-12">
                    <div class="ibox float-e-margins">
                        <div class="ibox-title">
                            <h5>联系我们</h5>
						<input type="hidden" id="id" value="${bearingContactDTO.id}" />
                        </div>
                        <div class="ibox-content" >
                        <form method="get" class="form-horizontal">
                           <div class="form-group">
                                <label class="col-sm-2 control-label">联系电话（座机）：</label>
                                <div class="col-sm-10">
                                    <input type="text"  id="adminTel" value="${bearingContactDTO.adminTel}" maxlength="20" class="form-control"> <span class="help-block m-b-none"></span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            
                            <div class="form-group">
                                <label class="col-sm-2 control-label">传真：</label>
                                <div class="col-sm-10">
                                    <input type="text" id="adminFax" value="${bearingContactDTO.adminFax}" maxlength="20"  class="form-control"> <span class="help-block m-b-none"></span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            
                            <div class="form-group">
                                <label class="col-sm-2 control-label">联系手机：</label>
                                <div class="col-sm-10">
                                    <input type="text" id="adminPhone" value="${bearingContactDTO.adminPhone}" maxlength="20"  class="form-control"> <span class="help-block m-b-none"></span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            
                            <div class="form-group">
                                <label class="col-sm-2 control-label">联系QQ：</label>
                                <div class="col-sm-10">
                                    <input type="text" id="adminQQ" value="${bearingContactDTO.adminQQ}" maxlength="20"  class="form-control"> <span class="help-block m-b-none"></span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            
                            <div class="form-group">
                                <label class="col-sm-2 control-label">联系微信：</label>
                                <div class="col-sm-10">
                                    <input type="text" id="adminWeixin" value="${bearingContactDTO.adminWeixin}" maxlength="30"  class="form-control"> <span class="help-block m-b-none"></span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            
                            <div class="form-group">
                                <label class="col-sm-2 control-label">联系地址：</label>
                                <div class="col-sm-10">
                                    <textarea  type="text" id="adminAddress" class="form-control" maxlength="200"  >${bearingContactDTO.adminAddress}</textarea> <span class="help-block m-b-none"></span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            
                            <div class="ibox-content" >
								<label class="col-sm-2 control-label">微信二维码：</label>
								<div class="col-sm-10">
								<input type="file" name="fileField" id="fileField" class="file" size="28" onchange="uploadImage(this,id);"  />
								<span class="help-block m-b-none">图片大小为300px* 300px</span>
								</div>
								<!-- onchange="uploadImage(this,id);"  ${base}/uploadImage.htm-->
		                            <div class="dropzone-previews">
		                            <#if imageVO?exists && imageVO.imageUrl != '' >
		                            	<a href="javascript:void(0);" onclick="delImg('${imageVO.imageName}');" id="image">
		                            	<img data-dz-thumbnail='' alt="点击删除" title="点击删除" style="width:110px;height:110px;" id='imgUrl' imgurl='${imageVO.imageName}'  src='${imageVO.imageUrl}' />
		                            	</a>
		                            </#if>
		                            </div>
		                            <!-- <button type="submit" class="btn btn-primary pull-right">提交</button> -->
                        	</div>
                            <div class="hr-line-dashed"></div>
                            
                           <!--  <div class="ibox-content" >
								<label class="col-sm-2 control-label">轴承图片：</label>
								<div class="col-sm-10">
								<input type="file" name="fileField" id="fileField" class="file" size="28" onchange="uploadImage(this,id);"  />
								<span class="help-block m-b-none">图片大小为300px* 300px</span>
								</div>
								onchange="uploadImage(this,id);"  ${base}/uploadImage.htm
		                            <div class="dropzone-previews">
		                            	<#list picUrlList as picUrl>
		                            	<img data-dz-thumbnail='' id='imgUrl' imgUrl='${picUrl}'  src='${picUrl}' />
		                            	</#list>
		                            </div>
		                            <button type="submit" class="btn btn-primary pull-right">提交</button>
                        	</div>
                            <div class="hr-line-dashed"></div> -->
                            
                            <div class="col-md-12">
								<div class="col-sm-12 col-sm-offset-3">
								    <button class="btn btn-primary" onclick="save();" type="button">保存</button>
								    <button class="btn btn-white" onclick="history.go(-1);" type="button">返回</button>
								</div>
							</div>
						<div class="hr-line-dashed"></div>
							</form>


                        </div>
                    </div>
                </div>
            </div>
        </div>
    <script src="${resRoot}/js/jquery.min.js"></script>
    <script src="${resRoot}/js/bootstrap.min.js"></script>
    <script src="${resRoot}/js/plugins/footable/footable.all.min.js"></script>
    <script src="${resRoot}/js/content.min.js"></script>
    <script src="${resRoot}/js/plugins/layer/layer.min.js"></script>
    <script type="text/javascript" src="${resRoot}/js/ajaxfileupload.js"></script>
    <!-- <script>
        $(document).ready(function(){$(".footable").footable();$(".footable2").footable()});
    </script> -->
    <script type="text/javascript">
    	function save() {
    		var adminTel = $("#adminTel").val();
    		var adminFax = $("#adminFax").val();
    		var adminPhone=$("#adminPhone").val();
    		var adminQQ=$("#adminQQ").val();
    		var adminWeixin=$("#adminWeixin").val();
    		var adminAddress=$("#adminAddress").val();
    		var weixinImg = $("#imgUrl").attr("imgurl");
    		$.ajax({
				type : "post",
				url : "${base}/contact/save.htm",
				data : {
					adminTel : adminTel,
					adminFax : adminFax,
					adminPhone : adminPhone,
					adminQQ : adminQQ,
					adminWeixin : adminWeixin,
					adminAddress : adminAddress,
					weixinImg : weixinImg
				},
				dataType : "json",
				async : false,
				success : function(data) {
					flag  = data.message;
					if(flag == 1) {
						alert("保存成功！");
						window.location.href="${base}/contact/show.htm";
					} else if(flag == 2) {
						layer.alert("数据错误，请完善数据！");
					} else if(flag == 0){
						layer.alert("服务器异常！");
					}
				}
			});
    		
    	}
    	
    	function uploadImage(fileField,id) {
				$.ajaxFileUpload({
					type : "post",
					url : "${base}/uploadImage.do",
					data : {
						fileField : fileField
					},
					secureuri: false,
					fileElementId : id,
					dataType: "json",
					async : false,
					success : function(data) {
						if(data != "") {
							$(".dropzone-previews").append("<a href='javascript:void(0);' onclick='delImg(" + data.imageName + ");'><img data-dz-thumbnail='' style='width:110px;height:110px;' title='点击删除' id='imgUrl' " + "imagename='" + data.imageName +  "' imgurl='" + data.imageName + "' src='"+ data.imageUrl +"' /></a>");
						}
					},
					error : function(data) {
				          alert("网络异常，请重试");
				    }
				});
		}
    	
    	function delImg (id) {
    		if(confirm("确认删除该图片吗？")){
	    		$.ajax({
					type : "post",
					url : "${base}/contact/delImage.htm",
					data : {
						imageName : id
					},
					dataType : "json",
					async : false,
					success : function(data) {
						flag  = data.message;
						if(flag == 1) {
				    		$("#image").remove();
						} else {
							layer.alert("服务器异常！");
						}
					}
				});
    		}
    	}
    </script>
</body>


</html>
